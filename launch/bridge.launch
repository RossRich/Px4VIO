<launch>
  <arg name="camera" default="camera_t265" />

  <!-- Launch static transform publishers -->
  <node pkg="tf2_ros" type="static_transform_publisher" name="tf_baseLinkFrd_$(arg camera)Pose" args="0.11 0 0.025 0 -0.79 -3.14 base_link_frd $(arg camera)_pose_frame" />

  <!-- Launch static transform publishers -->
  <node pkg="tf2_ros" type="static_transform_publisher" name="tf_odom_$(arg camera)Odom" args="0 0 0 0 0 0 odom $(arg camera)_odom_frame" />

  <!-- launch node to throttle images for logging -->
  <!-- <node name="drop_image1" pkg="topic_tools" type="drop" output="screen" args="/camera/fisheye1/image_raw  9 10" /> -->
  <!-- <node name="drop_image2" pkg="topic_tools" type="drop" output="screen" args="/camera/fisheye2/image_raw  9 10" /> -->

  <!-- Throttle odometry messages to a fixed rate around 25Hz -->
  <node name="odom_throttler" type="drop" pkg="topic_tools" args="/$(arg camera)/odom/sample 3 4 /$(arg camera)/odom/sample_throttled" />

  <!-- Launch Realsense Camera -->
  <include file="$(find realsense2_camera)/launch/rs_t265.launch">
    <arg name="enable_fisheye1" value="false" />
    <arg name="enable_fisheye2" value="false" />
    <arg name="fisheye_fps" value="30" />
    <arg name="gyro_fps" value="200" />
    <arg name="accel_fps" value="62" />
    <arg name="enable_gyro" value="false" />
    <arg name="enable_accel" value="false" />
    <arg name="publish_odom_tf" value="false" />
    <arg name="camera" value="$(arg camera)" />
    <arg name="initial_reset" value="true" />
    <arg name="linear_accel_cov" value="0.03" />
  </include>

  <env name="ROSCONSOLE_CONFIG_FILE" value="$(find px4_realsense_bridge)/resource/custom_rosconsole.conf" />

  <arg name="input_topic" default="/$(arg camera)/odom/sample_throttled" />

  <!-- Bridge node -->
  <node name="px4_realsense_bridge_node" pkg="px4_realsense_bridge" type="px4_realsense_bridge_node" output="screen">
    <param name="input_topic" value="$(arg input_topic)" />
  </node>

</launch>